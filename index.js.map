{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '53124504-9ef9dc7d083288085c55b9d9d';\nconst PER_PAGE = 15;\n\nexport async function fetchPhotosByQuery(query, page = 1) {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: PER_PAGE,\n        page,\n      },\n    });\n\n    return response.data;\n  } catch (error) {\n    throw new Error(error.message);\n  }\n}\n","export const createGalleryCardTemplate = imgInfo => {\n  return `\n    <li class=\"gallery-card\">\n      <a href=\"${imgInfo.largeImageURL}\">\n        <img\n          class=\"gallery-img\"\n          src=\"${imgInfo.webformatURL}\"\n          alt=\"${imgInfo.tags}\"\n        />\n      </a>\n      <ul class=\"info\">\n        <li><b>Likes</b> ${imgInfo.likes}</li>\n        <li><b>Views</b> ${imgInfo.views}</li>\n        <li><b>Comments</b> ${imgInfo.comments}</li>\n        <li><b>Downloads</b> ${imgInfo.downloads}</li>\n      </ul>\n    </li>\n  `;\n};","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\n\nimport { fetchPhotosByQuery } from './js/pixabay-api';\nimport { createGalleryCardTemplate } from './js/render-functions';\n\nconst refs = {\n  form: document.querySelector('.js-search-form'),\n  gallery: document.querySelector('.js-gallery'),\n  loader: document.querySelector('.js-loader'),\n  loadMoreBtn: document.querySelector('.js-load-more'),\n};\n\nlet query = '';\nlet page = 1;\nlet totalHits = 0;\n\nconst lightbox = new SimpleLightbox('.js-gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nrefs.form.addEventListener('submit', onSearchFormSubmit);\nrefs.loadMoreBtn.addEventListener('click', onLoadMoreClick);\n\nasync function onSearchFormSubmit(e) {\n  e.preventDefault();\n  query = e.target.elements.user_query.value.trim();\n  refs.gallery.innerHTML = '';\n  page = 1;\n  refs.loadMoreBtn.classList.add('hidden');\n\n  if (!query) {\n    iziToast.warning({\n      message: 'Please enter a search query before submitting!',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  refs.loader.classList.add('is-active');\n\n  try {\n    const data = await fetchPhotosByQuery(query, page);\n    totalHits = data.totalHits;\n\n    if (!data.hits.length) {\n      iziToast.info({\n        message: 'Sorry, there are no images matching your search query.',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    renderGallery(data.hits);\n\n    if (data.hits.length < totalHits) {\n      refs.loadMoreBtn.classList.remove('hidden');\n    }\n  } catch (error) {\n    iziToast.error({\n      message: 'Something went wrong. Please try again later.',\n      position: 'topRight',\n    });\n  } finally {\n    refs.loader.classList.remove('is-active');\n    e.target.reset();\n  }\n}\n\nasync function onLoadMoreClick() {\n  page += 1;\n  refs.loader.classList.add('is-active');\n\n  try {\n    const data = await fetchPhotosByQuery(query, page);\n    renderGallery(data.hits, true);\n\n    const totalPages = Math.ceil(totalHits / 15);\n    if (page >= totalPages) {\n      refs.loadMoreBtn.classList.add('hidden');\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n\n    smoothScroll();\n  } catch (error) {\n    iziToast.error({\n      message: 'Something went wrong. Please try again later.',\n      position: 'topRight',\n    });\n  } finally {\n    refs.loader.classList.remove('is-active');\n  }\n}\n\nfunction renderGallery(images, append = false) {\n  const markup = images.map(createGalleryCardTemplate).join('');\n  if (append) {\n    refs.gallery.insertAdjacentHTML('beforeend', markup);\n  } else {\n    refs.gallery.innerHTML = markup;\n  }\n  lightbox.refresh();\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } =\n    refs.gallery.firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["BASE_URL","API_KEY","PER_PAGE","fetchPhotosByQuery","query","page","axios","error","createGalleryCardTemplate","imgInfo","refs","totalHits","lightbox","SimpleLightbox","onSearchFormSubmit","onLoadMoreClick","iziToast","data","renderGallery","totalPages","smoothScroll","images","append","markup","cardHeight"],"mappings":"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"}